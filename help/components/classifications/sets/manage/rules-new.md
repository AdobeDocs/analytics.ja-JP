---
title: 分類セットルール
description: 分類セットルールを使用して、分類データのルールを定義する方法を説明します。
feature: Classifications
hide: true
hidefromtoc: true
source-git-commit: 9192849bf9fd9a72d2ad7ae2f9727a13201a2a33
workflow-type: tm+mt
source-wordcount: '1578'
ht-degree: 13%

---


# 分類セットルール

ルールを使用すると、主要なディメンションが絶えず変化するシナリオで自動分類をサポートできます。 アップロードまたは自動化を通じた分類の更新が面倒なプロセスになる、または新しいディメンション値の適切な分類が遅れる。 例えば、内部キャンペーン、トラッキングコード、製品 SKU などです。 ディメンションには、値から分類データを派生できるように、1 つ以上のルールを適用できる値が含まれている必要があります。

分類セットのコンテキスト内でルールを定義します。これは、分類セットを購読しているすべてのレポートスイートとキーディメンションの組み合わせにルールが（アクティブ化されると）適用されることを意味します。 この実装は、従来の分類ルールビルダーの動作方法とは多少異なります。 分類ルールビルダーでは、ルールセットの一部として 1 つ以上のルールを個別に定義してから、ルールセットを 1 つ以上のレポートスイートに関連付けます。 新しいインターフェイスでは、分類セット内のルールはルールセットとも呼ばれますが、他の分類セット属性を設定する同じインターフェイス内で定義されます。


分類セットのルールセットを定義するには：

1. Adobe Analytics の上部メニューバーで&#x200B;**[!UICONTROL コンポーネント]**&#x200B;を選択し、**[!UICONTROL 分類セット]**&#x200B;を選択します。
1. **[!UICONTROL 分類セット]**&#x200B;で、「**[!UICONTROL 分類セット]**」タブを選択します。
1. **[!UICONTROL 分類セット]** マネージャーで、ルールを定義する分類セットを選択します。
1. **[!UICONTROL 分類セット：_分類セット名_]**ダイアログで、「**[!UICONTROL ルール]**」タブを選択します。

   * 分類セットに初めて **[!UICONTROL ルール]** インターフェイスにアクセスする場合、またはこれまで従来のルールビルダーインターフェイスを引き続き使用することにした場合は、開始方法を選択できるダイアログが表示されます。 次のオプションがあります。

      * **既存のルールを移行** します。 現在の分類ルールを読み込んで、新しいインターフェイスでこれらのルールの使用を続行します。 既存のルールが保持され、新しい形式に変換されます。
         * 「**[!UICONTROL ルールを移行]**」を選択して続行します。
         * **[!UICONTROL 移行を確認]** ダイアログで、移行の影響を確認します。
            * **[!UICONTROL ルールを移行]** を選択して、移行を確定します。 移行が完了したら、[ ルールセットインターフェイス ](#rule-set-interface) を使用して新しいルールを作成し、既存の移行済みルールを編集します。
            * 「**[!UICONTROL キャンセル]**」を選択して移行をキャンセルします

      * **新たに開始**。 新しいルールビルダーを使用して、ゼロから新しい分類ルールを作成します。 分類ロジックを再設計する場合や、新しい分類ルールを使用して新たに開始する場合は、このオプションを選択します。
         * **[!UICONTROL 新しいルールを作成]** を選択して続行します。
         * **[!UICONTROL 新規開始を確認]** ダイアログで、新規開始の影響を読みます。
            * **[!UICONTROL 新規開始]** を選択して新規開始を確定し、既存のルールを破棄します。 [ ルールセットインターフェイス ](#rule-set-interface) を使用して、新しいルールを作成します。
            * 「**[!UICONTROL キャンセル]**」を選択すると、キャンセルします。


      * **従来のインターフェイスを使用** します。 以前のルールビルダーインターフェイスを引き続き使用します。 新しいエクスペリエンスへの移行は、準備が整ったらいつでも実行できます。
         * **[!UICONTROL 従来のインターフェイスに移動]** を選択して続行します。 従来の **[!UICONTROL 分類ルールビルダー]** インターフェイスに移動します。

   * 既にルールを移行している場合や、分類セットに対して新しいルールを作成した場合は、最終的にルールセットインターフェイスに直接移動します。



## ルールセットインターフェイス

ルールを作成または編集する場合は、ルールセット インターフェイスを使用します。

![ ルールセットインターフェイス ](assets/rulesets-ui.png)

| | 名前 | 説明 |
|---|---|---|
| 1 | **[!UICONTROL 関数]** | 「**[!UICONTROL 関数]**」領域を使用して、関数を選択し、ルールセットビルダーにドラッグ&amp;ドロップします。 |
| 2 | **ルールセットビルダー** | ルールセットを作成するには、1 つ以上のルールを使用します。 ルールは関数の実装であり、常に 1 つの関数にのみ関連付けられます。 1 つの関数に複数の演算子を含めることができます。 ルールを作成するには、関数をルールセットビルダーにドラッグ&amp;ドロップします。 関数タイプは、ルールのインターフェイスを定義します。 <br/> 詳しくは、[ ルールインターフェイス ](#rule-interface) を参照してください。<br/> 関数は、任意の場所に挿入できます。また、関数を順番に実行して、分類の最終的な値を決定します。<br/> すべて折りたたむ **[!UICONTROL を使用してすべてのルールを折りたたむ]** と、**[!UICONTROL すべて展開する]** を使用してすべてのルールを展開します。 |
| 3 | **[!UICONTROL ステータス]** | ルールセットのステータスと最終変更日を表示します。 <br/> 「**[!UICONTROL アクティブ化]**」を選択して、ルールセットをアクティブ化します。 <br/> 「**[!UICONTROL 無効化]**」を選択して、ルールセットを無効化します。 |
| 4 | **[!UICONTROL ルックバック]** | ルールセットのルックバックウィンドウを指定します。<br/> ドロップダウンメニューからオプションを選択します（1 か月から 6 か月）。<br/> 「**[!UICONTROL ルックバックを実行]**」を選択し、選択したルックバック期間を使用してルックバックを実行します。 |
| 5 | **[!UICONTROL テストオプション]** | サンプルキーディメンション値を使用して、分類をテストします。 <ul><li>**[!UICONTROL サンプルキー]** テキスト領域に値を追加または貼り付けます。<br/> 「**[!UICONTROL サンプルキーを記憶]**」にチェックを入れて、ルールセットインターフェイスの様々な使用方法にわたってサンプルキーが保持されるようにします。</li><li>「**[!UICONTROL ルールセットをテスト]**」を選択して、ルールセットをテストします。</li></ul> |


## ルールインターフェイス

ルールインターフェイスのルールセット内で個々のルールを定義します。 インターフェイスには、次の要素があります。

![ ルールインターフェイス ](assets/rule-ui.png)

| | 説明 |
|---|---|
| 1 | 選択した関数の名前と、その関数に対して入力された入力。 |
| 2 | 選択した関数の入力。 入力は、選択した関数によって異なります。 例えば、正規表現関数の入力は正規表現で、分割関数の入力はトークンです。 特定の関数に適切な入力を入力します。 例えば、内部キャンペーンコードで 3 つの分類を識別する正規表現の `^(.+)\:(.+)\:(.+)$` です。 |
| 3 | 各操作は、特定の分類を値に設定します。 <br/> 分類を設定 **** ドロップダウンメニューから分類を選択し、「**[!UICONTROL から]** の値を入力します。 リストから操作を削除するには <br/>![CrossSize400](/help/assets/icons/CrossSize400.svg) を使用します。 |
| 4 | 「![ 追加 ](/help/assets/icons/Add.svg)**[!UICONTROL 追加操作]**」を選択して、関数に操作を追加します。 |
| 5 | ![ChevronDown](/help/assets/icons2/ChevronDown.svg) を選択して、ルールを折りたたみます。 ![ChevronLeft](/help/assets/icons/ChevronLeft.svg) を選択して、ルールを展開します。<br/>![CrossSize400](/help/assets/icons/CrossSize400.svg) を選択して、ルールを削除します。 |

## 関数リファレンス

サポートされている各関数について、必要な入力とサンプルのユースケースに関する詳細を以下で確認します。


### 次で始まる…

キーディメンションの開始元となる特定の値に基づいて分類を設定します。

+++ 詳細 

#### 必要な入力

**[!UICONTROL 次で始まる]** の値を入力します。 例：`em`。

#### ユースケース

キーディメンション内部キャンペーンの値が `Email` で始まる場合（例：**[!UICONTROL ）、]** を `em` チャネル `em:FY2025:Summer Sale` 分類の値として自動的に割り当てるルールを定義します。

>[!BEGINTABS]

>[!TAB  ルール ]

![ ルール – 次で始まる ](assets/rule-startswith.png)

>[!TAB  テストの結果 ]

![ ルール – テスト結果で始まる ](assets/rule-startswith-test.png)

>[!ENDTABS]

+++



### 次で終わる…

キーディメンションが終わる特定の値に基づいて分類を設定します。

+++ 詳細 

#### 必要な入力

**[!UICONTROL 次で終わる]** の値を入力します。 例：`2025`。

#### ユースケース

キーディメンション内部キャンペーンの値に `2025` が含まれている場合（例：**[!UICONTROL ）、]** を `2025` 年 `em:Summer Sale:FY2025` 分類の値として自動的に割り当てるルールを定義します。

>[!BEGINTABS]

>[!TAB  ルール ]

![ ルール – 次で終わる ](assets/rule-endswith.png)

>[!TAB  テストの結果 ]

![ ルール – テスト結果で終わる ](assets/rule-endswith-test.png)

>[!ENDTABS]

+++


### 含む…

キーディメンションに含まれる特定の値に基づいて分類を設定します。

+++ 詳細 

#### 必要な入力

**[!UICONTROL 次を含む]** の値を入力します。 例：`Winter`。

#### ユースケース

キーディメンション内部キャンペーンの値に `Winter Sale` が含まれる場合（例：**[!UICONTROL ）に、]** を `Winter` タイプ `fb:Winter:FY2024` 分類の値として自動的に割り当てるルールを定義します。


>[!BEGINTABS]

>[!TAB  ルール ]

![ ルール – 次を含む ](assets/rule-contains.png)

>[!TAB  テストの結果 ]

![ ルール – 結果を含む ](assets/rule-contains-test.png)

>[!ENDTABS]

+++


### 次に一致

キーディメンションが一致する特定の値に基づいて分類を設定します。

+++ 詳細 

#### 必要な入力

**[!UICONTROL 一致]** の値を入力します。 例：`em:FY2025:Summer`。

#### ユースケース

キーディメンション Internal Campaign の値が `Email` と一致する場合、**[!UICONTROL を]** チャネル `Summer Sale` 分類の値として、**[!UICONTROL を]** タイプ `2025`**[!UICONTROL 分類の値として、]** 年 `em:FY2025:Summer` 分類の値として自動的に割り当てるルールを定義します。


>[!BEGINTABS]

>[!TAB  ルール ]

![ ルール – 一致 ](assets/rule-match.png)

>[!TAB  テストの結果 ]

![ ルール – 一致 ](assets/rule-match.png)

>[!ENDTABS]

+++


### 正規表現

キーディメンション値に適用される正規表現に基づいて 1 つ以上の分類を設定します。

+++ 詳細 

#### 必要な入力

**[!UICONTROL 正規表現]** の値を入力します。 例：`^(.+)\:(.+)\:FY(.+)$`。

#### ユースケース

正規表現 **[!UICONTROL を適用し、キーディメンション Internal Campaign の値に一致グループ]****[!UICONTROL 、]** および **[!UICONTROL ）を使用して、]** Channel`^(.+)\:(.+)\:FY(.+)$`、`$1`Type および `$2`Year`$3` 分類の値を自動的に割り当てるルールを定義する必要があります。

>[!BEGINTABS]

>[!TAB  ルール ]

![ ルール – 正規表現 ](assets/rule-regex.png)

>[!TAB  テストの結果 ]

![ ルール – 正規表現テストの結果 ](assets/rule-regex-test.png)

>[!ENDTABS]


#### 参照テーブル {#section_0211DCB1760042099CCD3ED7A665D716}

| 正規表現 | 説明 |
|---|---|
| `(?ms)` | 正規表現全体を複数行の入力と照合し、任意の改行文字に一致するワイルドカード |
| `(?i)` | 正規表現全体で大文字と小文字を区別しないようにする |
| `[abc]` | a、b または c の 1 文字 |
| `[^abc]` | a、b、c 以外の 1 文字 |
| `[a-z]` | a ～ z の範囲内の 1 文字 |
| `[a-zA-Z]` | a ～ z または A ～ Z の範囲内の 1 文字 |
| `^` | 行の開始（行の開始に一致） |
| `$` | 行の末尾（または末尾の新しい行の前に一致） |
| `\A` | 文字列の開始 |
| `\z` | 文字列の末尾 |
| `.` | 任意の文字の一致（改行を除く） |
| `\s` | 空白文字 |
| `\S` | 空白以外の文字 |
| `\d` | 数字 |
| `\D` | 数字以外 |
| `\w` | 任意の単語（文字、数字、アンダースコア） |
| `\W` | 任意の単語以外の文字 |
| `\b` | 任意の単語境界 |
| `(...)` | 囲まれている内容をすべてキャプチャ |
| `(a\b)` | a または b |
| `a?` | 0 または 1 個の a |
| `a*` | 0 個以上の a |
| `a+` | 1 つ以上の a |
| `a{3}` | 3 個の a |
| `a{3,}` | 3 個以上の a |
| `a{3,6}` | 3 ～ 6 個の a |

+++


## ルールの優先度

キーディメンション値が複数のルールに一致し、ルールセットに同じ「分類の設定」操作を持つルールが含まれている場合、最後のルールが分類の値を決定します。 したがって、最も重要なセット分類操作を、ルールセットの最後のルールの一部としてランク付けする必要があります。

同じ「分類を設定」操作を共有しない複数のルールを作成する場合、処理順序は関係ありません。


### 例

検索文字列をキーディメンションとして使用して、ユーザーがアスリートを検索する方法を分類 **[!UICONTROL タイプ]** で分類する場合。 例えば、次のルールセットを使用します。

![ ルールの優先度 ](assets/rule-priority.png)

* ユーザーが `Cowboys Fantasy Tony Romo` を検索すると、`Romo` は **[!UICONTROL タイプ]** に分類されます。
* ユーザーが `Cowboys Fantasy Tony Romeo` を検索すると、`Fantasy` タイプ **[!UICONTROL に分類]** されます。
* ユーザーが `Cowboys vs. Broncos` を検索すると、`Team` タイプ **[!UICONTROL に分類]** されます。

