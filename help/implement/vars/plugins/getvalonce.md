---
title: getValOnce
description: Analytics変数が1行に2回同じ値に設定されないようにします。
translation-type: tm+mt
source-git-commit: 180ad544541f25d02b3a257559bc045abed7387b

---


# Adobeプラグイン：getValOnce

> [!IMPORTANT] このプラグインは、Adobe Analyticsからより多くの価値を引き出すのに役立つ、アドビコンサルティングによって提供されます。 アドビカスタマーケアは、インストールやトラブルシューティングを含め、このプラグインに対するサポートを行いません。 このプラグインに関するヘルプが必要な場合は、貴社のアカウントマネージャーにお問い合わせください。 担当コンサルタントとのミーティングを設定できます。

このプ `getValOnce` ラグインは、変数が同じ値に複数回設定されるのを防ぎます。 訪問者がページを更新した場合や、特定のページを複数回訪問した場合の重複を排除する場合は、このプラグインを使用することをお勧めします。 Analysis Workspaceの「回数」指標について心配しない場合は、このプラグインは不要です。

## Adobe Experience Platform Launch Extensionを使用してプラグインをインストールする

アドビでは、最も一般的に使用されるプラグインを使用できる拡張機能を提供しています。

1. Log in to [launch.adobe.com](https://launch.adobe.com) using your AdobeID credentials.
1. 目的のプロパティをクリックします。
1. 「拡張子」タブ [!UICONTROL に移動し] 、「カタログ」ボタンをクリッ [!UICONTROL クします] 。
1. Common Analytics Plugins  Extensionのインストールと公開
1. まだ「Initialize Plug-ins」というルールを作成していない場合は、次の設定を使用してルールを作成します。
   * 条件：なし
   * イベント：コア — ライブラリ読み込み済み（ページの上部）
1. 次の設定を使用して、上記のルールにアクションを追加します。
   * 拡張子：共通のAnalyticsプラグイン
   * アクションタイプ：getValOnceの初期化
1. ルールに対する変更を保存して発行します。

## カスタムコードエディターの起動を使用したプラグインのインストール

プラグイン拡張機能を使用しない場合は、カスタムコードエディターを使用できます。

1. Log in to [launch.adobe.com](https://launch.adobe.com) using your AdobeID credentials.
1. 目的のプロパティをクリックします。
1. 「拡張」タブ [!UICONTROL に移動し] 、Adobe Analytics拡張機能の [!UICONTROL 下にある「設定] 」ボタンをクリックします。
1. 「カスタムコー [!UICONTROL ドを使用してトラッキングを設定] 」アコーディオンを展開すると、「エディターを開く  」ボタンが表示されます。
1. カスタムコードエディターを開き、下に示すプラグインコードを編集ウィンドウに貼り付けます。
1. 変更を保存し、Analytics拡張機能に公開します。

## AppMeasurementを使用したプラグインのインストール

Analyticsトラッキングオブジェクトをインスタンス化した後（を使用して）、AppMeasurementファイルの任意の場所に次のコードをコピーして貼り付 `s_gi`けます。 コードのコメントとバージョン番号を実装に保持しておくと、アドビは潜在的な問題のトラブルシューティングに役立ちます。

```js
/******************************************* BEGIN CODE TO DEPLOY *******************************************/
/* Adobe Consulting Plugin: getValOnce v2.0 */
s.getValOnce=function(vtc,cn,et,ep){if(vtc&&(cn=cn||"s_gvo",et=et||0,ep="m"===ep?6E4:864E5,vtc!==this.c_r(cn))){var e=new Date;e.setTime(e.getTime()+et*ep);this.c_w(cn,vtc,0===et?0:ep);return vtc}return""};
/******************************************** END CODE TO DEPLOY ********************************************/
```

## プラグインの使用

このメソ `getValOnce` ッドでは、次の引数を使用します。

* **`vtc`**（必須、文字列）:以前に同じ値に設定されていたかどうかを確認する変数
* **`cn`**（オプション、文字列）:確認する値を保持するcookieの名前。 デフォルトは`"s_gvo"`
* **`et`**（オプション、整数）:cookieの有効期限（日単位、または引数に応じて分単位）`ep`です。 デフォルト`0`はに設定され、ブラウザーセッションの終わりに有効期限が切れます。
* **`ep`**（オプション、文字列）:この引数は、引数も設定されている場`et`合にのみ設定してください。 この引数を日数ではな`"m"`く分単位で期限切れに`et`する場合は、に設定します。 デフォルト`"d"`は日単位で引数`et`を設定します。

引数とcookie `vtc` の値が一致する場合、このメソッドは空の文字列を返します。 引数と `vtc` cookieの値が一致しない場合、このメソッドは引数を文字列 `vtc` として返します。

## 呼び出しの例

### 例1

この呼び出しを使用して、同じ値が次の30日間連続でs.campaignに複数回渡されるのを防ぎます。

```js
s.campaign=s.getValOnce(s.campaign,"s_campaign",30);
```

上記の呼び出しでは、プラグインはまず、s_campaign cookieに既に含まれている値と、現在のs.campaign変数から取得されている値を比較します。   一致が行われない場合、プラグインはs_campaign cookieをs.campaignからの新しい値と同じに設定し、新しい値を返します。   この比較は今後30日間行われる

### 例2

この呼び出しを使用して、セッション全体で同じ値が設定されるのを防ぎます。

```js
s.eVar2=s.getValOnce(s.eVar2,"s_ev2",0,"m");
```

このコードは、ユーザーのセッション中に同じ値がs.eVar2に2回以上連続して渡されるのを防ぎます。  また、有効期限が0に設定されているので、（呼び出しの最後に）引数の「m」値も無視します。   また、このコードは比較値をs_ev2 cookieに保存します。

## バージョン履歴

### 2.0

* ポイントリリース（再コンパイル、コードサイズが小さい）。

### 1.1

* パラメーターを使用して、有効期限に関する分または日を選択するオプションが追加さ `t` れました。
* プラグインのみに制限す `k` るために使用する変数のスコープを修正。 この変更により、ページ上の他のコードとの干渉が発生する可能性を回避できます。
